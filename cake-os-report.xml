<?xml version="1.0" encoding="UTF-8"?>

<?xml-stylesheet href="http://moise.sourceforge.net/xml/os.xsl" type="text/xsl" ?>

<organisational-specification
	id="cake" os-version="0.8"

	xmlns='http://moise.sourceforge.net/os'
	xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'>

	<structural-specification>

		<role-definitions>
			<role id="baker" />
			<role id="apprentice" />
			<role id="customer" />
		</role-definitions>

		<group-specification id="bakery">
			<roles>
				<role id="baker" min="1" max="1" />
				<role id="apprentice" min="1" max="1" />
				<role id="customer" min="1" max="1" />
			</roles>
		</group-specification>

	</structural-specification>

	<functional-specification>

		<scheme id="cake_sch">

			<goal id="produceAndEatCake">
				<plan operator="sequence">
					<goal id="prepareCake">
						<plan operator="sequence">
							<goal id="collectIngredients" />
							<goal id="mixIngredients" />
							<goal id="bakeCake" />
						</plan>
					</goal>
					<goal id="sellCake">
						<plan operator="sequence">
							<goal id="provideMoney" />
							<goal id="takePayment" />
							<goal id="deliverCake" />
						</plan>
					</goal>
					<goal id="eatCake">
						<plan operator="choice">
							<goal id="giveToMySon" />
							<goal id="eatMyself" />
						</plan>
					</goal>
				</plan>
			</goal>

			<goal id="confirmIngredients" />
			<goal id="explainIngredients" />
			<goal id="provideAmount" />
			<goal id="prepareCardOrCash" />

			<mission id="mApprentice" min="1" max="1">
				<goal id="collectIngredients" />
				<goal id="mixIngredients" />
				<goal id="bakeCake" />
				<report id="confirmationIngredients" when="satisfied(cake_sch,collectIngredients)">
					<goal id="confirmIngredients" />
				</report>
			</mission>
			<mission id="mBaker" min="1" max="1">
				<goal id="takePayment" />
				<goal id="deliverCake" />
				<goal id="prepareCake" />
				<goal id="sellCake" />
				<report id="ingredients" when="satisfied(cake_sch,prepareCake)">
					<goal id="explainIngredients" />
				</report>
				<report id="amount" when="satisfied(cake_sch,prepareCake)">
					<goal id="provideAmount" />
				</report>
				<treatment id="askConfirmationIngredients" reporting="confirmationIngredients" />
			</mission>
			<mission id="mCustomer" min="1" max="1">
				<goal id="provideMoney" />
				<goal id="giveToMySon" />
				<goal id="eatMyself" />
				<treatment id="askIngredients" reporting="ingredients" />
				<treatment id="askAmount" reporting="amount">
					<goal id="prepareCardOrCash" />
				</treatment>
			</mission>

		</scheme>
	</functional-specification>

	<normative-specification>
		<norm id="n1" type="obligation" role="customer" mission="mCustomer" />
		<norm id="n2" type="obligation" role="apprentice" mission="mApprentice" />
		<norm id="n3" type="obligation" role="baker" mission="mBaker" />
	</normative-specification>

</organisational-specification>
